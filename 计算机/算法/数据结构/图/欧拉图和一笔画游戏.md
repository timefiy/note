---
title: "欧拉图和一笔画游戏"
source: "https://labuladong.online/zh/algo/data-structure-basic/eulerian-graph/"
author:
  - "[[labuladong]]"
published:
created: 2026-02-06
description: "欧拉图是图论中的一个概念，它是指一个无向图其中每个顶点的度数都是偶数，或者一个有向图其中每个顶点的入度和出度都相等。欧拉图的性质是，如果一个图是欧拉图，那么它一定存在一条欧拉回路，即从任意一个顶点出发，经过每条边恰好一次，最后回到起点。"
tags:
  - "clippings"
---
前置知识

阅读本文前，你需要先学习：

- [图结构术语](https://labuladong.online/zh/algo/data-structure-basic/graph-terminology/)
- [图结构的 DFS/BFS 遍历](https://labuladong.online/zh/algo/data-structure-basic/graph-traverse-basic/)

一句话总结

「一笔画」游戏的本质是寻找欧拉路径/欧拉回路，可以通过节点的度数判断是否存在欧拉路径/欧拉回路。

Hierholzer 算法是用于计算欧拉路径/欧拉回路的经典算法，它是 [图结构 DFS 算法](https://labuladong.online/zh/algo/data-structure-basic/graph-traverse-basic/) 的拓展。

欧拉图是图论中的经典概念，起源于著名的哥尼斯堡七桥问题。这个问题不仅在数学史上具有重要意义，在现代计算机科学中也有广泛应用，比如路径规划、电路设计等。

考虑到这是基础章节，所以不会详细讲解代码实现，具体的算法代码以及习题会安排在数据结构章节的图论部分讲解。

本文主要介绍欧拉图的定义、经典的七桥问题、欧拉路径和欧拉回路的概念，以及寻找欧拉路径的技巧，你可以在本站配套的一笔画小游戏中直观地感受到。

## 一笔画游戏

我记得小时候玩过「一笔画」小游戏，规则就是要求你一笔连接所有的点和边，其中点可以重复经过，但每条边必须恰好经过一次，不能重复经过。

网站配套的游戏面板也收录了这个小游戏：

一笔画游戏

小时候玩这种游戏就是全靠运气，随便选择起点开始乱走一通，能走完就走完，走不完就重新开始。

后来才知道这个益智小游戏其实是一个经典的图论算法，而且有套路可循。

现在就可以告诉你完成游戏的套路：

- 如果所有节点的度数都是偶数，那么可以从任何节点开始，一定可以完成一笔画，且最终会回到起点。
- 如果只有两个节点的度数为奇数，那么必须从这两个奇数度节点中的任意一个开始，才能完成一笔画。
- 如果上面两种情况都不满足，那么无法完成一笔画。

游戏面板中会显示每个节点的 [度数](https://labuladong.online/zh/algo/data-structure-basic/graph-terminology/) ，你可以先试试看这个套路好不好用：）

下面我们来介绍这个小游戏背后的图论知识 - 欧拉图。

## 七桥问题

欧拉图的概念源于 18 世纪著名的哥尼斯堡七桥问题。当时的哥尼斯堡（现在的加里宁格勒）有一条河流将城市分为南北两岸，河中有东西两个小岛，有七座桥连接着北岸、南岸、东岛和西岛。

问题是：能否设计一条路线，从任意一个区域出发，经过每座桥恰好一次，最后回到起点？

我们可以将这个问题抽象成图论问题：

在这幅图中：

- 每个区域对应一个节点
- 每座桥对应一条边
- 问题转化为：是否存在一条路径，经过图中每条边恰好一次，且最终回到起点

最终，欧拉通过数学证明七桥问题无解，从而解决了这个著名问题。

## 术语定义

基于七桥问题，我们引入几个图论术语：

**欧拉路径（Eulerian Path）** ：在图中找到一条路径，使得每条边都被遍历恰好一次的路径。

**欧拉回路（Eulerian Circuit）** ：欧拉路径的特殊情况，即起点和终点是同一个节点的欧拉路径。

根据这两个概念，我们可以对图进行分类，分为三类：

- **欧拉图（Eulerian Graph）** ：存在欧拉回路的图
- **半欧拉图（Semi-Eulerian Graph）** ：存在欧拉路径但不存在欧拉回路的图
- **非欧拉图（Non-Eulerian Graph）** ：既不存在欧拉路径也不存在欧拉回路的图

让我们看几个例子：

这幅图存在欧拉回路，比如 `1->2->3->4->1` 这条路径经过了每条边恰好一次并回到起点。所以这幅图是欧拉图。

这幅图不存在欧拉回路，但是存在欧拉路径，比如 `1->2->3->4->1->3` 这条路径经过了每条边恰好一次，但起点和终点不同。所以这幅图是半欧拉图。

不难发现，七桥问题就等价于欧拉图的判定问题，下面介绍如何快速判断一个图是否是欧拉图。

## 欧拉图的判定

### 无向图

对于无向连通图：

欧拉图（存在欧拉回路）的充要条件是 **所有节点的度数都是偶数** 。

半欧拉图（存在欧拉路径）的充要条件是 **有且仅有两个节点的度数为奇数** 。

为什么存在这样的规律呢？因为度数的奇偶性决定了节点的「进出」特性。

在欧拉路径中，除了起点和终点，每个中间节点都必须是「进一次，出一次」的配对关系，所以这些中间节点的度必然是偶数。

起点和终点比较特殊，它们的度可以是奇数，因为起点可以多一条出边，终点可以多一条入边。

如果起点和终点恰巧是同一个节点，那么所有节点的度数都是偶数，也就是存在欧拉回路，属于欧拉路径的特殊情况。

让我们回到哥尼斯堡七桥问题，计算每个节点的度数：

- 节点 A（北岸）：度数为 3
- 节点 B（南岸）：度数为 3
- 节点 C（东岛）：度数为 3
- 节点 D（西岛）：度数为 5

由于所有节点的度数都是奇数（超过两个奇数度节点），所以这个图不存在欧拉路径，这证明了七桥问题无解。

### 有向图

在有向图中，我们需要区分入度和出度，因此判定条件略有不同。

欧拉图（存在欧拉回路）的充要条件是 **每个节点的入度等于出度** 。

半欧拉图（存在欧拉路径）的充要条件是 **有一个节点出度比入度多 1，有一个节点入度比出度多 1，其余节点入度等于出度** 。

其中的原理和无向图是类似的，起点可以多一条出边，终点可以多一条入边，其余节点的入度和出度必须相等。

如果起点和终点恰好是同一个节点，那么每个节点的入度和出度就都相等了，即存在欧拉回路。

让我们看几个有向图的例子：

在这个图中：

- 节点 1：入度 = 1，出度 = 1
- 节点 2：入度 = 1，出度 = 1
- 节点 3：入度 = 1，出度 = 1
- 节点 4：入度 = 1，出度 = 1

所有节点的入度都等于出度，存在欧拉回路： `1->2->3->4->1` 。

在这个图中：

- 节点 1：入度 = 1，出度 = 2（出度比入度多 1）
- 节点 2：入度 = 1，出度 = 1
- 节点 3：入度 = 2，出度 = 1（入度比出度多 1）
- 节点 4：入度 = 1，出度 = 1

存在欧拉路径： `1->2->3->4->1->3` ，但起点和终点不同，所以不存在欧拉回路。

## 寻找欧拉路径的算法

寻找欧拉路径的经典算法是 Hierholzer 算法，具体的代码和例题讲解会放到数据结构章节的图论算法部分。

这里我们不妨打开思路，尝试利用已有的知识，看看能否大力飞砖，自己实现一个寻找欧拉路径的算法？

其实可以复用 [图结构的 DFS/BFS 遍历](https://labuladong.online/zh/algo/data-structure-basic/graph-traverse-basic/) 中的遍历算法。在讲 DFS 算法的时候，我们专门区分了「遍历所有节点」，「遍历所有边」和「遍历所有路径」的场景。

寻找欧拉路径本质上就是寻找一条能够经过所有边的路径嘛，而且我们可以通过每个节点的度数来确定起点和终点，所以最简单的思路就是：

1、先计算每个节点的度数，确定欧拉路径的起点和终点。

2、使用「遍历所有路径」的 DFS 算法，从起点开始遍历，遍历到终点时检查 `onPath` 数组，如果所有边都被访问过，则找到了欧拉路径。

这个思路肯定是可以完成任务的，我们都暴力穷举所有路径了，难道还怕找不到欧拉路径？只不过这个思路的时间复杂度比较高。因为穷举所有路径的过程中，我们可能重复遍历一些边。假设图中有 $E$ 条边，那么时间复杂度肯定会超过 $O(E)$ 。

Hierholzer 算法的本质是 DFS 算法的逆后序遍历，时间复杂度是 $O(E)$ 。

也就是说，你把「遍历所有边」的 DFS 算法的后序遍历结果算出来，然后 reverse 一下，就得到了欧拉路径。

是不是很神奇？这里面的原理和具体的代码实现，我们会在 [Hierholzer 算法寻找欧拉路径](https://labuladong.online/zh/algo/data-structure/eulerian-graph-hierholzer/) 中详细探讨。

更新时间：2026/02/05 12:53

## 评论

Markdown

Ctrl+Enter 发表